{% include datasets/method_header.html data_source=include.data_source method="Upsert" %}

<div class="container" style="padding:0">
<div class="row">
<div class="col">
<p>
Updates existing {{include.data_source | downcase}} in <code>{{include.data_source}}.df</code> and inserts new {{include.data_source | downcase}} into the dataframe.
</p>

<p>
<code>{{include.data_source}}.df</code> is overwritten with the updated data. The dataframe is not saved automatically following the upsert - call <a href="#save"><code>{{include.data_source}}.save()</code></a> to save the dataset.
</p>

<h4>Arguments</h4>


<table class="table table-sm params">
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>
created_gt<br/>
<code>optional</code> <code>datetime</code>
</td>
<td>
Return {{include.data_source | downcase}} created after this value. If not provided, only new rows created after <code>{{include.data_source}}.updated</code> are inserted and existing rows are not updated.
</td>
</tr>
</tbody>
</table>

</div>
<div class="col code_samples">
<ul class="nav nav-tabs " id="myTab" role="tablist">
<li class="nav-item">
<a class="nav-link active" id="home-tab" data-toggle="tab" href="#python_upsert" role="tab" aria-controls="home" aria-selected="true">Python</a>
</li>
</ul>
<div class="tab-content" id="myTabContent">
<div class="tab-pane fade show active" id="python_upsert" role="tabpanel" aria-labelledby="home-tab">
{% highlight python %}
import petaldata
from datetime import datetime, timedelta

petaldata.datasets.{{page.toc_title | downcase}}.api_key = "[YOUR {{page.toc_title | upcase}} API KEY]"

{{include.data_source | downcase}} = petaldata.datasets.{{page.toc_title | downcase}}.{{include.data_source}}()
{{include.data_source | downcase}}.upsert(created_gt=datetime.now() - timedelta(days=30))
# Access {{include.data_source | downcase}} via a Pandas Dataframe
df = {{include.data_source | downcase}}.df
{% endhighlight %}
</div>
</div>
</div> <!-- col -->
</div>
</div>

<hr/>